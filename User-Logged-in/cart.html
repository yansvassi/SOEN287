<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Bag</title>
    <link rel="stylesheet" href="../cartStyles.css">
    <link rel="stylesheet" href="../BrowseStyles.css">
    <link rel="stylesheet" href="../navStyles.css">
    <!-- Add styles for the logged-in navbar -->
    <link rel="stylesheet" href="../mpstyle.css">
    <link rel="stylesheet" href="../footerStyles.css">
    <link rel="stylesheet" href="../MainPageStyle.css">
    <script src="../navbarscroll.js"></script>
</head>
<body>

<!-- Placeholder for the logged-in navbar -->
<div id="logged-in-navbar"></div>

<!-- JavaScript to load the logged-in navbar -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        fetch('../User-Logged-in/loggedInNav.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('logged-in-navbar').innerHTML = data;
            })
            .catch(error => console.error('Error loading logged-in navbar:', error));
    });
</script>

<!-- Cart content -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Retrieve the cart data from localStorage
        const cart = JSON.parse(localStorage.getItem('cart')) || [];

        const cartContainer = document.querySelector('.cart-container');
        cartContainer.innerHTML = ''; // Clear the cart before adding items

        cart.forEach((product, index) => {
            const cartItem = `
                <div class="cart-item" id="cart-item-${index}">
                    <div class="item-details">
                        <h3>${product.name}</h3>
                    </div>
                    <div class="item-price">$${product.price}</div>
                    <div class="item-quantity">
                        <button class="minus-btn" onclick="changeQuantity(${index}, -1)">-</button>
                        <span class="quantity" id="quantity-${index}">${product.quantity}</span>
                        <button class="plus-btn" onclick="changeQuantity(${index}, 1)">+</button>
                    </div>
                    <div class="item-total" id="total-${index}">$${(product.price * product.quantity).toFixed(2)}</div>
                    <div class="item-remove">
                        <button onclick="removeFromCart(${index})">&times;</button>
                    </div>
                </div>
            `;
            cartContainer.innerHTML += cartItem;
        });
    });

    function changeQuantity(index, delta) {
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        const product = cart[index];

        if (product) {
            product.quantity += delta;

            // Prevent negative quantities
            if (product.quantity <= 0) {
                removeFromCart(index);
            } else {
                // Update the quantity in the DOM
                document.getElementById(`quantity-${index}`).innerText = product.quantity;
                // Update the total price in the DOM
                document.getElementById(`total-${index}`).innerText = `$${(product.price * product.quantity).toFixed(2)}`;

                // Save the updated cart back to localStorage
                localStorage.setItem('cart', JSON.stringify(cart));
            }
        }
    }

    function removeFromCart(index) {
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        cart.splice(index, 1);  // Remove the item at the given index
        localStorage.setItem('cart', JSON.stringify(cart));

        // Remove the cart item from the DOM
        document.getElementById(`cart-item-${index}`).remove();
    }
</script>



<div class="cart-container">
    

</div>

<!-- Footer -->
<div id="footer-container"></div>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    fetch('../footer.html')
            .then(response => response.text())
            .then(data => {
              document.getElementById('footer-container').innerHTML = data;
            })
            .catch(error => console.error('Error loading footer:', error));
  });
</script>

<script src="../script.js"></script>

</body>
</html>
